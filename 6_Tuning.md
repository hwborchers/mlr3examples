---
title: "Tuning"
author: "Hans W. Borchers"
date: "July 2020"
output:
  html_document:
    css: "mlr3.css"
    keep_md: true
    toc: true
    toc_float:
      collapsed: false
---





We will use the same data and task as before.

```r
Glass <- RWeka::read.arff("glass.arff")

task <- TaskClassif$new(id = "glass",
                        backend = Glass, target = "Type")
```


## Hyperparameter tuning

The default of the number of small trees generated by the 'ranger' Random Forrest algorithm is 500. For a small data set this may be a much too big number of trees.

We will in *mlr3* determine an optimal number of trees through the "hyperparameter tuning" mechanism. First define the resampling method as before.

```r
cv5 = rsmp("cv", folds = 10)
```


```r
ps = ParamSet$new(list(
  ParamInt$new("num.trees", lower = 50, upper = 500))
)
```


```r
at = AutoTuner$new(
  learner = lrn("classif.ranger"),
  resampling = rsmp("cv", folds = 10),
  measures = msr("classif.acc"),
  tune_ps = ps,
  terminator = term("evals", n_evals = 20),
  tuner = TunerRandomSearch$new()
)
```


```r
resample(task = task,
         learner = at,
         resampling = rsmp("holdout"))
```

```
## INFO  [22:26:43.579] Applying learner 'classif.ranger.tuned' on task 'glass' (iter 1/1) 
## INFO  [22:26:45.366] Starting to tune 1 parameters with '<TunerRandomSearch>' and '<TerminatorEvals>' 
## INFO  [22:26:45.413] Terminator settings: n_evals=20 
## INFO  [22:26:45.457] Evaluating 1 configurations 
## INFO  [22:26:45.461]  num.trees 
## INFO  [22:26:45.461]        129 
## INFO  [22:26:45.514] Benchmark with 10 resampling iterations 
## INFO  [22:26:45.516] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:45.561] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:45.603] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:45.637] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:45.681] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:45.738] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:45.771] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:45.814] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:45.844] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:45.885] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:45.945] Finished benchmark 
## INFO  [22:26:45.971] Result of batch 1: 
## INFO  [22:26:45.974]  num.trees classif.acc 
## INFO  [22:26:45.974]        129   0.7614286 
## INFO  [22:26:45.976] 1 configurations evaluated 
## INFO  [22:26:46.084] Evaluating 1 configurations 
## INFO  [22:26:46.089]  num.trees 
## INFO  [22:26:46.089]        384 
## INFO  [22:26:46.127] Benchmark with 10 resampling iterations 
## INFO  [22:26:46.128] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:46.185] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:46.230] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:46.302] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:46.362] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:46.427] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:46.488] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:46.539] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:46.598] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:46.656] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:46.746] Finished benchmark 
## INFO  [22:26:46.757] Result of batch 2: 
## INFO  [22:26:46.760]  num.trees classif.acc 
## INFO  [22:26:46.760]        384   0.7185714 
## INFO  [22:26:46.762] 2 configurations evaluated 
## INFO  [22:26:46.797] Evaluating 1 configurations 
## INFO  [22:26:46.799]  num.trees 
## INFO  [22:26:46.799]        258 
## INFO  [22:26:46.831] Benchmark with 10 resampling iterations 
## INFO  [22:26:46.832] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:46.888] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:46.941] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:46.977] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:47.084] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:47.118] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:47.167] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:47.201] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:47.249] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:47.286] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:47.350] Finished benchmark 
## INFO  [22:26:47.362] Result of batch 3: 
## INFO  [22:26:47.364]  num.trees classif.acc 
## INFO  [22:26:47.364]        258   0.7333333 
## INFO  [22:26:47.365] 3 configurations evaluated 
## INFO  [22:26:47.397] Evaluating 1 configurations 
## INFO  [22:26:47.398]  num.trees 
## INFO  [22:26:47.398]        393 
## INFO  [22:26:47.425] Benchmark with 10 resampling iterations 
## INFO  [22:26:47.427] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:47.483] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:47.542] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:47.598] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:47.647] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:47.720] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:47.778] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:47.840] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:47.916] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:47.986] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:48.064] Finished benchmark 
## INFO  [22:26:48.075] Result of batch 4: 
## INFO  [22:26:48.078]  num.trees classif.acc 
## INFO  [22:26:48.078]        393   0.7328571 
## INFO  [22:26:48.079] 4 configurations evaluated 
## INFO  [22:26:48.097] Evaluating 1 configurations 
## INFO  [22:26:48.098]  num.trees 
## INFO  [22:26:48.098]        197 
## INFO  [22:26:48.140] Benchmark with 10 resampling iterations 
## INFO  [22:26:48.142] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:48.174] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:48.220] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:48.252] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:48.315] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:48.366] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:48.399] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:48.446] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:48.481] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:48.528] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:48.587] Finished benchmark 
## INFO  [22:26:48.601] Result of batch 5: 
## INFO  [22:26:48.603]  num.trees classif.acc 
## INFO  [22:26:48.603]        197   0.7261905 
## INFO  [22:26:48.605] 5 configurations evaluated 
## INFO  [22:26:48.622] Evaluating 1 configurations 
## INFO  [22:26:48.624]  num.trees 
## INFO  [22:26:48.624]        484 
## INFO  [22:26:48.669] Benchmark with 10 resampling iterations 
## INFO  [22:26:48.671] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:48.754] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:48.821] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:48.899] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:48.966] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:49.016] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:49.082] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:49.144] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:49.209] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:49.272] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:49.361] Finished benchmark 
## INFO  [22:26:49.372] Result of batch 6: 
## INFO  [22:26:49.375]  num.trees classif.acc 
## INFO  [22:26:49.375]        484   0.7190476 
## INFO  [22:26:49.377] 6 configurations evaluated 
## INFO  [22:26:49.410] Evaluating 1 configurations 
## INFO  [22:26:49.411]  num.trees 
## INFO  [22:26:49.411]         77 
## INFO  [22:26:49.439] Benchmark with 10 resampling iterations 
## INFO  [22:26:49.441] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:49.466] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:49.506] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:49.532] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:49.571] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:49.597] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:49.646] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:49.670] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:49.711] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:49.735] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:49.784] Finished benchmark 
## INFO  [22:26:49.799] Result of batch 7: 
## INFO  [22:26:49.801]  num.trees classif.acc 
## INFO  [22:26:49.801]         77   0.7480952 
## INFO  [22:26:49.802] 7 configurations evaluated 
## INFO  [22:26:49.819] Evaluating 1 configurations 
## INFO  [22:26:49.821]  num.trees 
## INFO  [22:26:49.821]        260 
## INFO  [22:26:49.862] Benchmark with 10 resampling iterations 
## INFO  [22:26:49.864] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:49.899] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:49.949] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:49.989] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:50.035] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:50.082] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:50.121] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:50.169] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:50.205] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:50.249] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:50.312] Finished benchmark 
## INFO  [22:26:50.324] Result of batch 8: 
## INFO  [22:26:50.326]  num.trees classif.acc 
## INFO  [22:26:50.326]        260   0.7257143 
## INFO  [22:26:50.328] 8 configurations evaluated 
## INFO  [22:26:50.345] Evaluating 1 configurations 
## INFO  [22:26:50.347]  num.trees 
## INFO  [22:26:50.347]        384 
## INFO  [22:26:50.401] Benchmark with 10 resampling iterations 
## INFO  [22:26:50.403] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:50.461] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:50.504] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:50.557] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:50.615] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:50.663] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:50.728] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:50.787] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:50.847] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:50.907] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:50.972] Finished benchmark 
## INFO  [22:26:50.996] Result of batch 9: 
## INFO  [22:26:50.998]  num.trees classif.acc 
## INFO  [22:26:50.998]        384   0.7185714 
## INFO  [22:26:50.999] 9 configurations evaluated 
## INFO  [22:26:51.017] Evaluating 1 configurations 
## INFO  [22:26:51.018]  num.trees 
## INFO  [22:26:51.018]        433 
## INFO  [22:26:51.061] Benchmark with 10 resampling iterations 
## INFO  [22:26:51.063] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:51.128] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:51.181] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:51.241] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:51.316] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:51.378] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:51.446] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:51.518] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:51.567] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:51.634] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:51.744] Finished benchmark 
## INFO  [22:26:51.756] Result of batch 10: 
## INFO  [22:26:51.758]  num.trees classif.acc 
## INFO  [22:26:51.758]        433   0.7185714 
## INFO  [22:26:51.760] 10 configurations evaluated 
## INFO  [22:26:51.778] Evaluating 1 configurations 
## INFO  [22:26:51.780]  num.trees 
## INFO  [22:26:51.780]        223 
## INFO  [22:26:51.822] Benchmark with 10 resampling iterations 
## INFO  [22:26:51.823] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:51.858] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:51.902] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:51.946] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:51.997] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:52.039] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:52.077] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:52.121] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:52.154] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:52.200] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:52.262] Finished benchmark 
## INFO  [22:26:52.273] Result of batch 11: 
## INFO  [22:26:52.275]  num.trees classif.acc 
## INFO  [22:26:52.275]        223   0.7185714 
## INFO  [22:26:52.277] 11 configurations evaluated 
## INFO  [22:26:52.310] Evaluating 1 configurations 
## INFO  [22:26:52.313]  num.trees 
## INFO  [22:26:52.313]        488 
## INFO  [22:26:52.357] Benchmark with 10 resampling iterations 
## INFO  [22:26:52.359] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:52.426] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:52.489] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:52.558] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:52.608] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:52.680] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:52.742] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:52.804] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:52.865] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:52.914] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:53.009] Finished benchmark 
## INFO  [22:26:53.022] Result of batch 12: 
## INFO  [22:26:53.024]  num.trees classif.acc 
## INFO  [22:26:53.024]        488   0.7471429 
## INFO  [22:26:53.025] 12 configurations evaluated 
## INFO  [22:26:53.044] Evaluating 1 configurations 
## INFO  [22:26:53.046]  num.trees 
## INFO  [22:26:53.046]        459 
## INFO  [22:26:53.088] Benchmark with 10 resampling iterations 
## INFO  [22:26:53.090] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:53.159] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:53.209] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:53.271] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:53.331] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:53.411] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:53.488] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:53.557] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:53.620] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:53.670] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:53.768] Finished benchmark 
## INFO  [22:26:53.781] Result of batch 13: 
## INFO  [22:26:53.783]  num.trees classif.acc 
## INFO  [22:26:53.783]        459   0.7261905 
## INFO  [22:26:53.784] 13 configurations evaluated 
## INFO  [22:26:53.801] Evaluating 1 configurations 
## INFO  [22:26:53.803]  num.trees 
## INFO  [22:26:53.803]        330 
## INFO  [22:26:53.847] Benchmark with 10 resampling iterations 
## INFO  [22:26:53.849] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:53.908] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:53.951] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:54.004] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:54.064] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:54.106] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:54.173] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:54.221] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:54.262] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:54.324] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:54.390] Finished benchmark 
## INFO  [22:26:54.402] Result of batch 14: 
## INFO  [22:26:54.404]  num.trees classif.acc 
## INFO  [22:26:54.404]        330   0.7128571 
## INFO  [22:26:54.406] 14 configurations evaluated 
## INFO  [22:26:54.438] Evaluating 1 configurations 
## INFO  [22:26:54.442]  num.trees 
## INFO  [22:26:54.442]        405 
## INFO  [22:26:54.471] Benchmark with 10 resampling iterations 
## INFO  [22:26:54.472] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:54.524] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:54.586] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:54.634] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:54.709] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:54.768] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:54.836] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:54.898] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:54.961] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:55.006] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:55.072] Finished benchmark 
## INFO  [22:26:55.088] Result of batch 15: 
## INFO  [22:26:55.097]  num.trees classif.acc 
## INFO  [22:26:55.097]        405   0.6985714 
## INFO  [22:26:55.101] 15 configurations evaluated 
## INFO  [22:26:55.123] Evaluating 1 configurations 
## INFO  [22:26:55.124]  num.trees 
## INFO  [22:26:55.124]        460 
## INFO  [22:26:55.152] Benchmark with 10 resampling iterations 
## INFO  [22:26:55.153] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:55.210] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:55.275] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:55.349] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:55.412] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:55.470] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:55.533] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:55.596] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:55.658] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:55.720] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:55.796] Finished benchmark 
## INFO  [22:26:55.807] Result of batch 16: 
## INFO  [22:26:55.810]  num.trees classif.acc 
## INFO  [22:26:55.810]        460   0.7185714 
## INFO  [22:26:55.811] 16 configurations evaluated 
## INFO  [22:26:55.829] Evaluating 1 configurations 
## INFO  [22:26:55.831]  num.trees 
## INFO  [22:26:55.831]        339 
## INFO  [22:26:55.873] Benchmark with 10 resampling iterations 
## INFO  [22:26:55.874] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:55.917] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:55.973] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:56.020] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:56.086] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:56.126] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:56.176] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:56.229] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:56.270] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:56.321] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:56.389] Finished benchmark 
## INFO  [22:26:56.402] Result of batch 17: 
## INFO  [22:26:56.404]  num.trees classif.acc 
## INFO  [22:26:56.404]        339   0.7052381 
## INFO  [22:26:56.405] 17 configurations evaluated 
## INFO  [22:26:56.422] Evaluating 1 configurations 
## INFO  [22:26:56.424]  num.trees 
## INFO  [22:26:56.424]        456 
## INFO  [22:26:56.468] Benchmark with 10 resampling iterations 
## INFO  [22:26:56.470] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:56.531] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:56.599] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:56.649] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:56.718] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:56.772] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:56.824] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:56.882] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:56.942] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:57.004] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:57.082] Finished benchmark 
## INFO  [22:26:57.103] Result of batch 18: 
## INFO  [22:26:57.105]  num.trees classif.acc 
## INFO  [22:26:57.105]        456   0.7257143 
## INFO  [22:26:57.106] 18 configurations evaluated 
## INFO  [22:26:57.138] Evaluating 1 configurations 
## INFO  [22:26:57.141]  num.trees 
## INFO  [22:26:57.141]        165 
## INFO  [22:26:57.167] Benchmark with 10 resampling iterations 
## INFO  [22:26:57.168] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:57.211] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:57.239] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:57.276] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:57.328] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:57.372] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:57.402] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:57.445] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:57.474] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:57.514] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:57.557] Finished benchmark 
## INFO  [22:26:57.579] Result of batch 19: 
## INFO  [22:26:57.584]  num.trees classif.acc 
## INFO  [22:26:57.584]        165   0.7119048 
## INFO  [22:26:57.587] 19 configurations evaluated 
## INFO  [22:26:57.613] Evaluating 1 configurations 
## INFO  [22:26:57.615]  num.trees 
## INFO  [22:26:57.615]        278 
## INFO  [22:26:57.658] Benchmark with 10 resampling iterations 
## INFO  [22:26:57.660] Applying learner 'classif.ranger' on task 'glass' (iter 1/10) 
## INFO  [22:26:57.709] Applying learner 'classif.ranger' on task 'glass' (iter 2/10) 
## INFO  [22:26:57.756] Applying learner 'classif.ranger' on task 'glass' (iter 3/10) 
## INFO  [22:26:57.806] Applying learner 'classif.ranger' on task 'glass' (iter 4/10) 
## INFO  [22:26:57.844] Applying learner 'classif.ranger' on task 'glass' (iter 5/10) 
## INFO  [22:26:57.896] Applying learner 'classif.ranger' on task 'glass' (iter 6/10) 
## INFO  [22:26:57.938] Applying learner 'classif.ranger' on task 'glass' (iter 7/10) 
## INFO  [22:26:57.991] Applying learner 'classif.ranger' on task 'glass' (iter 8/10) 
## INFO  [22:26:58.358] Applying learner 'classif.ranger' on task 'glass' (iter 9/10) 
## INFO  [22:26:58.411] Applying learner 'classif.ranger' on task 'glass' (iter 10/10) 
## INFO  [22:26:58.463] Finished benchmark 
## INFO  [22:26:58.489] Result of batch 20: 
## INFO  [22:26:58.492]  num.trees classif.acc 
## INFO  [22:26:58.492]        278   0.7185714 
## INFO  [22:26:58.493] 20 configurations evaluated 
## INFO  [22:26:58.510] Finished tuning after 20 evals 
## INFO  [22:26:58.638] Tuned x: num.trees=129 
## INFO  [22:26:58.641] Tuned y: classif.acc=0.7614
```

```
## <ResampleResult> of 1 iterations
## * Task: glass
## * Learner: classif.ranger.tuned
## * Warnings: 0 in 0 iterations
## * Errors: 0 in 0 iterations
```


## Feature selection

### Filter-based

Filter methods assign an importance value to each feature. Based on these values the features can be ranked and selected for a feature subset.

```r
mlr_filters
```

```
## <DictionaryFilter> with 17 stored values
## Keys: anova, auc, carscore, cmim, correlation, disr, find_correlation,
##   importance, information_gain, jmi, jmim, kruskal_test, mim, mrmr,
##   njmim, performance, variance
```

Package *praznik* provides many information based variable importance measures, such as 'JMI' for "JointMutualInformation".

```r
# library(praznik)
filter = FilterJMI$new()
filter
```

```
## <FilterJMI:jmi>
## Task Types: classif
## Task Properties: -
## Packages: praznik
## Feature types: integer, numeric, factor, ordered
```

Apply the filter to the task.

```r
filter$calculate(task)
filter$print()
```

```
## <FilterJMI:jmi>
## Task Types: classif
## Task Properties: -
## Packages: praznik
## Feature types: integer, numeric, factor, ordered
##    feature     score
## 1:       K 3.5109125
## 2:      Fe 3.3297131
## 3:      Si 3.2683436
## 4:      Ba 3.2520795
## 5:      RI 2.7594236
## 6:      Na 2.1813854
## 7:      Al 1.5410882
## 8:      Ca 0.8523703
## 9:      Mg 0.4572579
```

Information gain id, e.g., implemented in *FSelectorRcpp*.

```r
library(FSelectorRcpp)
filter = FilterInformationGain$new()
filter
```

```
## <FilterInformationGain:information_gain>
## Task Types: classif, regr
## Task Properties: -
## Packages: FSelectorRcpp
## Feature types: integer, numeric, factor, ordered
```

```r
filter$calculate(task)
filter$print()
```

```
## <FilterInformationGain:information_gain>
## Task Types: classif, regr
## Task Properties: -
## Packages: FSelectorRcpp
## Feature types: integer, numeric, factor, ordered
##    feature     score
## 1:      Al 0.3924517
## 2:      Mg 0.3900908
## 3:       K 0.3763916
## 4:      Ca 0.3271963
## 5:      Ba 0.2858193
## 6:      Na 0.2319545
## 7:      RI 0.2303647
## 8:      Si 0.0000000
## 9:      Fe 0.0000000
```

The problem with all these feature selection approaches is that they all return different scores and rankings.

[Multi-objective hyperparameter tuning and feature selection using filter ensembles](https://arxiv.org/pdf/1912.12912.pdf)


### Wrapper-based

For wrapper-based feature selection there is a new *mlr3fselect* package that will be on CRAN in short time.

```r
# remotes::install_github("mlr-org/mlr3fselect")
library(mlr3fselect)
```

```
## 
## Attaching package: 'mlr3fselect'
```

```
## The following object is masked from 'package:mlr3tuning':
## 
##     mlr_terminators
```

We use the 'glass' data and the task as defined before.


```r
learner = lrn("classif.ranger")
resampling = rsmp("holdout")
measure = msr("classif.ce")
```

Next we define termination, an 'fselect' instance, random search for the 'fselector', and start the optimization. Possible 'terminators' (in package *bbotk) can be seen with `mlr_terminators`.


```r
# Define termination criterion
terminator = trm("evals", n_evals = 20)

# Create fselect instance
instance = FSelectInstanceSingleCrit$new(task = task,
  learner = learner,
  resampling = resampling,
  measure = measure,
  terminator = terminator)

# Load fselector
fselector = fs("random_search")

# Trigger optimization
fselector$optimize(instance)
```

```
## INFO  [22:26:59.473] Starting to optimize 9 parameter(s) with '<FSelectorRandomSearch>' and '<TerminatorEvals>' 
## INFO  [22:26:59.482] Evaluating 10 configuration(s) 
## INFO  [22:26:59.576] Benchmark with 10 resampling iterations 
## INFO  [22:26:59.578] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:26:59.629] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:26:59.708] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:26:59.775] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:26:59.835] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:26:59.885] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:26:59.944] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.064] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.202] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.313] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.408] Finished benchmark 
## INFO  [22:27:00.470] Result of batch 1: 
## INFO  [22:27:00.473]     Al    Ba    Ca    Fe     K    Mg    Na    RI    Si classif.ce 
## INFO  [22:27:00.473]  FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE  0.6619718 
## INFO  [22:27:00.473]  FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  0.2816901 
## INFO  [22:27:00.473]   TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE  0.3521127 
## INFO  [22:27:00.473]  FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE  0.5633803 
## INFO  [22:27:00.473]   TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  0.3521127 
## INFO  [22:27:00.473]  FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE  0.3380282 
## INFO  [22:27:00.473]  FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE  0.4366197 
## INFO  [22:27:00.473]   TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE  0.3943662 
## INFO  [22:27:00.473]   TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE  0.3521127 
## INFO  [22:27:00.473]   TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  0.2957746 
## INFO  [22:27:00.473]       resample_result 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.473]  <ResampleResult[18]> 
## INFO  [22:27:00.476] Evaluating 10 configuration(s) 
## INFO  [22:27:00.599] Benchmark with 10 resampling iterations 
## INFO  [22:27:00.600] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.668] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.737] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.805] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.854] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.913] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:00.978] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:01.043] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:01.113] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:01.164] Applying learner 'classif.ranger' on task 'glass' (iter 1/1) 
## INFO  [22:27:01.257] Finished benchmark 
## INFO  [22:27:01.356] Result of batch 2: 
## INFO  [22:27:01.359]     Al    Ba    Ca    Fe     K    Mg    Na    RI    Si classif.ce 
## INFO  [22:27:01.359]   TRUE  TRUE FALSE  TRUE  TRUE FALSE  TRUE FALSE FALSE  0.4647887 
## INFO  [22:27:01.359]   TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  0.5070423 
## INFO  [22:27:01.359]  FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  0.4507042 
## INFO  [22:27:01.359]   TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  0.3802817 
## INFO  [22:27:01.359]  FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE  0.4366197 
## INFO  [22:27:01.359]   TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  0.3239437 
## INFO  [22:27:01.359]  FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  0.7042254 
## INFO  [22:27:01.359]   TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  0.2816901 
## INFO  [22:27:01.359]   TRUE  TRUE FALSE  TRUE FALSE FALSE  TRUE FALSE  TRUE  0.5070423 
## INFO  [22:27:01.359]  FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  0.6056338 
## INFO  [22:27:01.359]       resample_result 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.359]  <ResampleResult[18]> 
## INFO  [22:27:01.365] Finished optimizing after 20 evaluation(s) 
## INFO  [22:27:01.366] Result: 
## INFO  [22:27:01.368]     Al   Ba   Ca   Fe    K    Mg   Na   RI   Si             features  x_domain 
## INFO  [22:27:01.368]  FALSE TRUE TRUE TRUE TRUE FALSE TRUE TRUE TRUE Ba,Ca,Fe,K,Na,RI,... <list[9]> 
## INFO  [22:27:01.368]  classif.ce 
## INFO  [22:27:01.368]   0.2816901
```

```
##       Al   Ba   Ca   Fe    K    Mg   Na   RI   Si             features
## 1: FALSE TRUE TRUE TRUE TRUE FALSE TRUE TRUE TRUE Ba,Ca,Fe,K,Na,RI,...
##     x_domain classif.ce
## 1: <list[9]>  0.2816901
```

```r
# View results
instance$result
```

```
##       Al   Ba   Ca   Fe    K    Mg   Na   RI   Si             features
## 1: FALSE TRUE TRUE TRUE TRUE FALSE TRUE TRUE TRUE Ba,Ca,Fe,K,Na,RI,...
##     x_domain classif.ce
## 1: <list[9]>  0.2816901
```


### Embedded

Some learners are capable to return to feature importance scores and a ranking based on their internal algorithm, for instance `rpart` or `ranger`, as we have seen above.
